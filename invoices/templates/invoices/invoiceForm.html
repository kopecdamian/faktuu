{% extends 'baseInvoice.html' %}

{% block title %}
    {% if invoice.invoice_number %}
        {{invoice.invoice_number}}
    {% else %}
        Dodaj Fakturę Sprzedazy
    {% endif %}
{% endblock %}

{% block titlePage %}
    {% if invoice.invoice_number %}
        {{invoice.invoice_number}}
    {% else %}
        Dodaj Fakturę Sprzedazy
    {% endif %}
{% endblock %}

{% block content %}
    <form method="post">
        {% csrf_token %}
        {{ form.as_p }} 
        <div id="product-container">
            {% for product in products %}
                <div class="product-entry">
                    <input type="hidden" name="productId[]" value={{product.id}}>
                    <label>Nazwa produktu:</label>
                    <input type="text" name="productName[]"placeholder="Nazwa" value={{product.name}}>
        
                    <label>Cena:</label>
                    <input type="number" name="productPrice[]" placeholder="Cena" value={{product.price}}>
        
                    <label>Ilość:</label>
                    <input type="number" name="productQuantity[]" placeholder="Ilość" value={{product.quantity}}>
                </div>
            {% empty %}
                
            {% endfor %}
        </div>
        <button id="add-product" type="button" class="btn btn-primary">Dodaj produkt</button>
        <button type="submit" class="btn btn-primary">Zapisz fakturę</button>
        <a href="{% url 'invoices:invoices' %}" class="btn btn-secondary">Anuluj</a>
    </form>
{% endblock %}

{% block script %}
    <script>
        document.getElementById("add-product").addEventListener("click", function (event) {
            event.preventDefault();
            let container = document.getElementById("product-container");

            let newProduct = document.createElement("div");
            newProduct.classList.add("product-item");

            newProduct.innerHTML = `
            <div class="product-entry">
                <input type="hidden" name="productId[]" value="">
                <label>Nazwa produktu:</label>
                <input type="text" name="productName[]"placeholder="Nazwa">

                <label>Cena:</label>
                <input type="number" name="productPrice[]" placeholder="Cena">

                <label>Ilość:</label>
                <input type="number" name="productQuantity[]" placeholder="Ilość">
            </div>
            `;

            container.appendChild(newProduct);
        })
    </script>
{% endblock %}